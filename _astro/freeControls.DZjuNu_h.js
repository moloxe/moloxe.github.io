function y(i){const a={};window.addEventListener("keydown",c=>{c.preventDefault(),a[c.code]=!0}),window.addEventListener("keyup",c=>{c.preventDefault(),a[c.code]=!1});function o(){i({UP:a.KeyE,DOWN:a.KeyQ,FRONT:a.KeyW,BACK:a.KeyS,LEFT:a.KeyA,RIGHT:a.KeyD,SPACE:a.Space}),requestAnimationFrame(o)}o()}function h(i,a){const o=i.canvas;o.style.cursor="grab",o.style.userSelect="none",o.style.touchAction="manipulation";let c=!1,r,d;function u(e){c=!0,r=e.x,d=e.y}document.addEventListener("mousedown",({clientX:e,clientY:n})=>{u({x:e,y:n}),o.style.cursor="grabbing"}),document.addEventListener("touchstart",({changedTouches:e})=>{const n=e[0];u({x:n.clientX,y:n.clientY})});function l(e){i.camera.spherical.theta+=3*(r-e.x)/window.innerWidth,i.camera.spherical.phi+=3*(d-e.y)/window.innerHeight,r=e.x,d=e.y}document.addEventListener("mousemove",e=>{c&&l({x:e.clientX,y:e.clientY})}),document.addEventListener("touchmove",e=>{if(!c)return;const n=e.changedTouches[0];l({x:n.clientX,y:n.clientY})}),document.addEventListener("mouseup",()=>{c=!1,o.style.cursor="grab"}),document.addEventListener("touchend",()=>{c=!1}),document.addEventListener("wheel",e=>{i.camera.spherical.radius+=e.deltaY*.001});const t=[0,0,0],s=.002;return y(e=>{const n=i.camera.spherical.theta;e.UP&&(t[1]+=s),e.DOWN&&(t[1]-=s),e.FRONT&&(t[0]-=s*Math.sin(n),t[2]-=s*Math.cos(n)),e.BACK&&(t[0]+=s*Math.sin(n),t[2]+=s*Math.cos(n)),e.LEFT&&(t[0]-=s*Math.cos(n),t[2]+=s*Math.sin(n)),e.RIGHT&&(t[0]+=s*Math.cos(n),t[2]-=s*Math.sin(n)),e.SPACE&&a?.onSpace?.(),i.camera.pos.x+=t[0],i.camera.pos.y+=t[1],i.camera.pos.z+=t[2],t[0]*=a?.slowDown?.x??.9,t[1]*=a?.slowDown?.y??.9,t[2]*=a?.slowDown?.z??.9}),{applyForce(e){t[0]+=e.x??0,t[1]+=e.y??0,t[2]+=e.z??0},getVelocity(){return{x:t[0],y:t[1],z:t[2]}},setVelocity(e){e.x!==void 0&&(t[0]=e.x),e.y!==void 0&&(t[1]=e.y),e.z!==void 0&&(t[2]=e.z)}}}export{h as f};
